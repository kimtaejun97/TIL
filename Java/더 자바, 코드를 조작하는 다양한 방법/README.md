# ðŸ’» ë” ìžë°”, ì½”ë“œë¥¼ ì¡°ìž‘í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²•.
*****

# ðŸ“Œ JVM, JDK, JRE
****
- ### JVM(Java Virtual Machine)
> - ìžë°”ì˜ ê°€ìƒ ë¨¸ì‹ , ìžë°”ì˜ ë°”ì´íŠ¸ ì½”ë“œ(class íŒŒì¼)ì„ OSì— ë§žëŠ” ì½”ë“œë¡œ ë³€í™˜í•˜ì—¬ ì‹¤í–‰.
> - ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì‹¤í–‰í•˜ëŠ” í‘œì¤€ì´ìž êµ¬í˜„ì²´.(JVMìžì²´ëŠ” í‘œì¤€, íŠ¹ì • ë²¤ë”ê°€ êµ¬í˜„í•œ JVMì€ êµ¬í˜„ì²´.)
> - íŠ¹ì • í”Œëž«í¼ì— ì¢…ì†ì .


- ### JRE(Java Runtime Environment)
> - JVM + í•µì‹¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ë° ìžë°” ëŸ°íƒ€ìž„ í™˜ê²½ì—ì„œ í•„ìš”í•œ í”„ë¡œí¼í‹° ì„¸íŒ…ì´ë‚˜ ë¦¬ì†ŒìŠ¤ íŒŒì¼.
> - ìžë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ì‹¤í•¼í•  ìˆ˜ ìžˆë„ë¡ êµ¬ì„±ëœ ë°°í¬íŒ.
> - ê°œë°œ ê´€ë ¨ ë„êµ¬ëŠ” í¬í•¨í•˜ì§€ ì•ŠëŠ”ë‹¤ (ê´€ë ¨ ë„êµ¬ëŠ” JDKì—ì„œ ì œê³µ)


- ### JDK(Java Development Kit)
> - JRE + ê°œë°œì— í•„ìš”í•œ íˆ´
> > appletviewr, apt, jar, jacadoc, javac, javap ...
> - ì†ŒìŠ¤ ì½”ë“œë¥¼ ìž‘ì„±í•  ë•Œ ì‚¬ìš©í•˜ëŠ” ìžë°” ì–¸ì–´ëŠ” í”Œëž«í¼ì— ë…ë¦½ì .
> - ì˜¤ë¼í´ Java11 ë¶€í„°ëŠ” JDKë§Œì„ ì œê³µ, JREë¥¼ ë³„ë„ë¡œ ì œê³µí•˜ì§€ ì•ŠìŒ.


- ### JAVA
> - JDKì— ë“¤ì–´ìžˆëŠ” ìžë°” ì»´íŒŒì¼ëŸ¬ javacë¥¼ ì‚¬ìš©í•˜ì—¬ ë°”ì´íŠ¸ì½”ë“œ(.class)ë¡œ ì»´íŒŒì¼ í•  ìˆ˜ ìžˆë‹¤.
> 

- ### JVM ì–¸ì–´
> - í´ë¡œì €, ê·¸ë£¨ë¹„, JRuby, Hython, Kotlin, Scala ... 
> - .class íŒŒì¼  
> 


# ðŸ“Œ JVMì˜ êµ¬ì¡°
*****
![img.png](img.png)     
:: ì¶œì²˜ : ë” ìžë°”, ì½”ë“œë¥¼ ì¡°ìž‘í•˜ëŠ” ë‹¤ì–‘í•œ ë°©ë²• - ì¸í”„ëŸ° ë°±ê¸°ì„ ë‹˜.       

- ### í´ëž˜ìŠ¤ ë¡œë” ì‹œìŠ¤í…œ.
> - .class ì—ì„œ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì½ê³  ë©”ëª¨ë¦¬ì— ì €ìž¥.
> 1. ë¡œë”© : í´ëž˜ìŠ¤ë¥¼ ì½ì–´ì˜´.
> 2. ë§í¬ : ë ˆí¼ëŸ°ìŠ¤ë¥¼ ì—°ê²°.
> 3. ì´ˆê¸°í™” : static ê°’ ì´ˆê¸°í™” ë° ë³€ìˆ˜ì— í• ë‹¹.


- ### ë©”ëª¨ë¦¬
> - ë©”ëª¨ë¦¬ ì˜ì—­ : í´ëž˜ìŠ¤ ìˆ˜ì¤€ì˜ ì •ë³´(í´ëž˜ìŠ¤ ì´ë¦„, ë¶€ëª¨ í´ëž˜ìŠ¤ ì´ë¦„, ë©”ì†Œë“œ, ë³€ìˆ˜)ë¥¼ ì €ìž¥. ê³µìœ ìžì›ìœ¼ë¡œ ì‚¬ìš©.
> - ë©”ì†Œë“œ ì˜ì—­ : ë©”ì†Œë“œ ì €ìž¥. ê³µìœ  ìžì›
> - íž™ ì˜ì—­ : ê°ì²´ë¥¼ ì €ìž¥. ê³µìœ  ìžì›.
> - ìŠ¤íƒ ì˜ì—­ : ì“°ë ˆë“œ ë§ˆë‹¤ ëŸ°íƒ€ìž„ ìŠ¤íƒì„ ìƒì„±, ê·¸ ì•ˆì— ë©”ì†Œë“œ í˜¸ì¶œì„ ìŠ¤íƒ í”„ë ˆìž„ì´ë¼ëŠ” ë¸”ëŸ­ìœ¼ë¡œ ìŒ“ìŒ.
    ì“°ë ˆë“œê°€ ì¢…ë£Œë  ë•Œ ëŸ°íƒ€ìž„ ìŠ¤íƒì€ í•¨ê»˜ ì‚¬ë¼ì§. í•´ë‹¹ ì“°ë ˆë“œì—ë§Œ ê³µìœ  ë¨.
> - PC(Program Counter) ë ˆì§€ìŠ¤í„° : ì“°ë ˆë“œ ë§ˆë‹¤ í˜„ìž¬ ì‹¤í–‰í•  ìŠ¤íƒ í”„ë ˆìž„ì„ ê°€ë¥´í‚¤ëŠ” í¬ì¸í„°.
> - ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ìŠ¤íƒ : ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ì¸í„°íŽ˜ì´ìŠ¤ë¥¼ í˜¸ì¶œí•˜ëŠ” ìŠ¤íƒ í”„ë ˆìž„ì„ ìƒì„±.
> > ðŸ§ ë„¤ì´í‹°ë¸Œ ë©”ì†Œë“œ ì¸í„°íŽ˜ì´ìŠ¤: ìžë°” ì• í”Œë¦¬ì¼€ì´ì…˜ì—ì„œ C, C++, ì–´ì…ˆë¸”ë¦¬ë¡œ ìž‘ì„±ëœ í•¨ìˆ˜ë¥¼ ì‚¬ìš©í•  ìˆ˜ ìžˆëŠ” ë°©ë²•ì„ ì œê³µ.


- ### ì‹¤í–‰ ì—”ì§„
> - ì¸í„°í”„ë¦¬í„° : ë°”ì´íŠ¸ ì½”ë“œë¥¼ í•œì¤„ì”© ì‹¤í–‰. 
> - JIT(Just In time) ì»´íŒŒì¼ëŸ¬ : ì¸í„° í”„ë¦¬í„°ì˜ íš¨ìœ¨ ìƒìŠ¹, ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ ë°œê²¬í•˜ë©´ JIT ì»´íŒŒì¼ëŸ¬ë¡œ ë°˜ë³µë˜ëŠ” ì½”ë“œë¥¼ ëª¨ë‘ ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ë°”ê¿”ë‘”ë‹¤. 
>  ì´ ë‹¤ìŒë¶€í„° ì¸í„°í”„ë¦¬í„°ëŠ” ë„¤ì´í‹°ë¸Œ ì½”ë“œë¡œ ì»´íŒŒì¼ëœ ì½”ë“œë¥¼ ë°”ë¡œ ì‚¬ìš©.
> - GC(Garbage Collector) : ë”ì´ìƒ ì°¸ì¡°ë˜ì§€ ì•ŠëŠ” ê°ì²´ë¥¼ ëª¨ì•„ ì •ë¦¬.



# ðŸ“Œ í´ëž˜ìŠ¤ ë¡œë”
***
![img_1.png](img_1.png)

### 1. ë¡œë”©
> - í´ëž˜ìŠ¤ ë¡œë”ê°€ .class íŒŒì¼ì„ ì½ê³  ê·¸ ë‚´ìš©ì— ë”°ë¼ ì ì ˆí•œ ë°”ì´ë„ˆë¦¬ í…Œì´í„°ë¥¼ ë§Œë“¤ê³  ë©”ì†Œë“œ ì˜ì—­ì— ì €ìž¥.
> - ì €ìž¥ í•˜ëŠ” ë°ì´í„° : í’€ íŒ¨í‚¤ì§€ ê²½ë¡œ, í´ëž˜ìŠ¤ ì´ë¦„
> - Class? | Interface?| Enum?
> - ë©”ì†Œë“œ, ë³€ìˆ˜
> > - ë¡œë”©ì´ ëë‚˜ë©´ íž™ ì˜ì—­ì— ì €ìž¥.

### 2. ë§í¬
> - Verify, Prepare, Resolve(optional) ì„¸ ë‹¨ê³„ë¡œ ë‚˜ëˆ„ì–´ì§
> - Verify : .class íŒŒì¼ì´ ìœ íš¨í•œì§€ ì²´í¬.
> - Preparation : í´ëž˜ìŠ¤ ë³€ìˆ˜(static)ì™€ ê¸°ë³¸ê°’ì— í•„ìš”í•œ ë©”ëª¨ë¦¬ ì¤€ë¹„.
> - Resolve : ì‹¬ë³¼ë¦­ ë ˆí¼ëŸ°ìŠ¤ë¥¼ ë©”ì†Œë“œ ì˜ì—­ì— ìžˆëŠ” ì‹¤ì œ ë ˆí¼ëŸ°ìŠ¤ë¡œ êµì²´.

### 3. ì´ˆê¸°í™”
> - Static ë³€ìˆ˜ì˜ ê°’ì„ í• ë‹¹


### í´ëž˜ìŠ¤ ë¡œë”ì˜ ê³„ì¸µêµ¬ì¡°.
> - ë¶€íŠ¸ ìŠ¤íŠ¸ëž© í´ëž˜ìŠ¤ ë¡œë” : ìµœìƒìœ„ í´ëž˜ìŠ¤ ë¡œë”, JAVA_HOME\libì— ìžˆëŠ” ì½”ì–´ ìžë°” APIë¥¼ ì œê³µ.
> - í”Œëž«í¼ í´ëž˜ìŠ¤ë¡œë” :JAVA_HOME\lib\extí´ë” | java.ext.dirs ì‹œìŠ¤í…œ ë³€ìˆ˜ì— í•´ë‹¹í•˜ëŠ” ìœ„ì¹˜ì— ìžˆëŠ” í´ëž˜ìŠ¤ë¥¼ ì½ëŠ”ë‹¤.
> - ì• í”Œë¦¬ì¼€ì´ì…˜ í´ëž˜ìŠ¤ ë¡œë” - ì• í”Œë¦¬ì—í‚¤ì…˜ í´ëž˜ìŠ¤íŒ¨ìŠ¤ì—ì„œ í´ëž˜ìŠ¤ë¥¼ ì½ëŠ”ë‹¤.
```java
{App}.class.getClassLoader();
{App}.class.getClassLoader().getPerent();
```



## ðŸ“Œ í…ŒìŠ¤íŠ¸ ì½”ë“œ ì»¤ë²„ë¦¬ì§€
### - JaCoCo Plugin

> - ë°”ì´í¬ ì½”ë“œì— ë§ˆí¬ë¥¼ í†µí•´ ì–¼ë§ˆë‚˜ ì‹¤í–‰ ë˜ì—ˆëŠ”ì§€ë¥¼ ì¸¡ì •.

- ### Gradle ì„¤ì •.
```java
plugins {
    id 'jacoco'
}

jacoco {
    // JaCoCo ë²„ì „
    toolVersion = '0.8.5'
}
```
```java
jacocoTestReport {
    reports {
        html.enabled true
        csv.enabled true
        xml.enabled false
    }
    finalizedBy('jacocoTestCoverageVerification')
}
jacocoTestCoverageVerification {
    violationRules {
        rule {
            enabled = true
            element = 'CLASS'

            limit {
                counter = 'BRANCH'
                value = 'COVEREDRATIO'
                minimum = 0.1
            }

            limit {
                counter = 'LINE'
                value = 'COVEREDRATIO'
                minimum = 0.1
            }
            excludes = ["*.LikeHeartController", "*.AccountService"]
            includes = ["*.*Service", "*.*Controller"]
        }

    }
}
```
- excludes, includesë¥¼ ì´ìš©í•˜ì—¬ ì²´í¬í•˜ê³  ì‹¶ì€ íŒ¨í‚¤ì§€, í´ëž˜ìŠ¤ë¥¼ ì„¤ì •.
- íŒ¨í‚¤ì§€.í´ëž˜ìŠ¤ì´ë¦„ì˜ í˜•ì‹ì„ ê°€ì§. ì™€ì¼ë“œì¹´ë“œ *ì‚¬ìš©.

> - element : ì»¤ë²„ë¦¬ì§€ì˜ ì²´í¬ ê¸°ì¤€
> > BUNDLE(default), PACKAGE, CLASS, SOURCEFILE, METHOD
> - counter : ê²€ì‚¬ ë‹¨ìœ„
> > -  LINE : ë¹ˆ ì¤„ì„ ì œì™¸í•œ ì½”ë“œ ë¼ì¸ ìˆ˜
> > - BRANCH : if, switch ë“± ì¡°ê±´ ë¶„ê¸° ìˆ˜
> > - CLASS, METHOD
> > -  INSTRUCTION(Java ë°”ì´íŠ¸ì½”ë“œ ëª…ë ¹ ìˆ˜)
> > - COMPLEXITY(ë³µìž¡ë„ ê³„ì‚°)
> - value : ì»¤ë²„ë¦¬ì§€ìœ¨ í‘œê¸°
> > - TOTALCOUNT : ì „ì²´ ìˆ˜
> > - MISSEDCOUNT, COVERDCOUNT 
> > - MISSEDRATIO, COVEREDRATIO(default) : 0~1ì‚¬ì´ì˜ ìˆ«ìžë¡œ ë¹„ìœ¨ì„ í‘œê¸°.
> - minimum : ìµœì†Œ ë„ë‹¬í•´ì•¼í•˜ëŠ” ì»¤ë²„ë¦¬ì§€ìœ¨, ë„ë‹¬í•˜ì§€ ëª»í•˜ë©´ ë¹Œë“œ ì‹¤íŒ¨.
```java
test {
    useJUnitPlatform()
    finalizedBy 'jacocoTestReport'
}
```

- Test > jacocoTestReport > jacocoTEstCoverageVerification ìˆœì„œë¡œ ì‹¤í–‰ë˜ì–´ì•¼ í•¨.
- finalizedByë¥¼ ì´ìš©í•˜ì—¬ ëë‚œ í›„ ë‹¤ìŒ taskê°€ ì‹¤í–‰ë  ìˆ˜ ìžˆë„ë¡ ì„¤ì •.

![img_2.png](img_2.png)

## ðŸ“Œ ë°”ì´íŠ¸ ì½”ë“œ ì¡°ìž‘ ë¼ì´ë¸ŒëŸ¬ë¦¬
***
> - ASM : https://asm.ow2.io/
> - Javassist : https://www.javassist.org/
> - ByteBuddy: https://bytebuddy.net/#/ (ê°€ìž¥ ì‹¬í”Œ)

- ### Javaagent
> -  Javaagent JAR íŒŒì¼ ìƒì„±.
> > - ì‹œìž‘í•  ë•Œ ë¶™ì´ëŠ” premainê³¼ ëŸ°íƒ€ìž„ ì¤‘ì— ë™ì ìœ¼ë¡œ ë¶™ì´ëŠ” agentmainì´ ìžˆë‹¤.
> > - Instrumentationì„ ì‚¬ìš©.
> - í´ëž˜ìŠ¤ ë¡œë”ê°€ í´ëž˜ìŠ¤ë¥¼ ì½ì–´ì˜¬ ë•Œ javaagentë¥¼ ê±°ì³ì„œ ë³€ê²½ëœ ë°”ì´íŠ¸ ì½”ë“œë¥¼ ì½ì–´ì™€ ì‚¬ìš©í•˜ê¸° ë•Œë¬¸ì—, ì»´íŒŒì¼ëœ .class íŒŒì¼ì˜ ë°”ì´íŠ¸ ì½”ë“œëŠ” ë³€ê²½ë˜ì§€ ì•ŠëŠ”ë‹¤.

```java
public static void premain(String agentArgs, Instrumentation inst) {
        new AgentBuilder.Default()
                .type(ElementMatchers.any())
                .transform((builder, typeDescription, classLoader, javaModule) -> builder.method(named("pullOut"))
                .intercept(FixedValue.value("Rabbit!")))
                .installOn(inst);
}
```
- Manifest to JAR í”ŒëŸ¬ê·¸ì¸ ì‚¬ìš©.
- ì‚¬ìš©í•  í”„ë¡œì íŠ¸ì˜ VM ì˜µì…˜ì—ì„œ -javaagent {JAR Path}


## - í™œìš©
> - í”„ë¡œê·¸ëž¨ ë¶„ì„ : ë²„ê·¸ ì°¾ê¸°, ì½”ë“œ ë³µìž¡ë„ ê³„ì‚°.
> - í´ëž˜ìŠ¤ íŒŒì¼ ìƒì„± : í”„ë¡ì‹œ, íŠ¹ì • API í˜¸ì¶œ ì œí•œ
> - ì†ŒìŠ¤ì½”ë“œë¥¼ ê±´ë“œë¦¬ì§€ ì•Šê³  ì½”ë“œ ë³€ê²½ì´ í•„ìš”í•œ ê²½ìš°
> > - í”„ë¡œíŒŒì¼ëŸ¬, ìµœì í™”, ë¡œê¹… ...

> - ìŠ¤í”„ë§ì—ì„œ ì»´í¬ë„ŒíŠ¸ ìŠ¤ìº”ì„ í•  ë•Œ ì‚¬ìš©(asm)
> > - ClassPathScanningCandidateComponentProvider -> SimpleMetadateaReder
> > - ClassReaderì™€ Visitorë¥¼ ì‚¬ìš©í•´ì„œ í´ëž˜ìŠ¤ì— ìžˆëŠ” ë©”íƒ€ ì •ë³´ë¥¼ ì½ì–´ì˜´.


## ðŸ“Œ ë¦¬í”Œë ‰ì…˜ API
****
> - [ReflectionAPI ì •ë¦¬](../ReflectionAPI/README.md)
> 
