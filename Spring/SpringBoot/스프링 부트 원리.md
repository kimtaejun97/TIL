#ğŸ§ ìŠ¤í”„ë§ ë¶€íŠ¸ë€?
********
> - ìš´ì˜ ìˆ˜ì¤€ì˜ ìŠ¤í”„ë§ ê¸°ë°˜ ì• í”Œë¦¬ì¼€ì´ì…˜ì„ ë¹ ë¥´ê³  ì‰½ê²Œ ë„ì™€ì¤€ë‹¤.
> - ë„ë¦¬ ì“°ì´ëŠ” ê¸°ë³¸ ì„¤ì •ì„ ì œê³µí•´ì¤€ë‹¤.
> - ìŠ¤í”„ë§ ë¿ë§Œ ì•„ë‹ˆë¼ third-party libraryë“¤ì— ëŒ€í•œ ì„¤ì •ë„ ì§€ì›.
> - ì„¤ì •ì„ ì‰½ê³  ë¹ ë¥´ê²Œ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.
> - xml ì„¤ì •, code generationì„ ì‚¬ìš©í•˜ì§€ ì•ŠëŠ”ë‹¤.
> - Java 8 ì´ìƒë¶€í„° ì§€ì›.

```xml
<parent>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-parent</artifactId>
    <version>2.5.2</version>
    <relativePath/> <!-- lookup parent from repository -->
</parent>

<dependencies>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-web</artifactId>
</dependency>
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-test</artifactId>
    <scope>test</scope>
</dependency>
</dependencies>

<build>
<plugins>
    <plugin>
        <groupId>org.springframework.boot</groupId>
        <artifactId>spring-boot-maven-plugin</artifactId>
    </plugin>
</plugins>
</build>
```


#### â˜‘ï¸ìŠ¤í”„ë§ ë¶€íŠ¸ í”„ë¡œì íŠ¸ ìƒì„±ê¸°
    -  start.spring.io


# ğŸ“œ ëª©ì°¨
****
- #### [ì˜ì¡´ì„± ê´€ë¦¬ ì´í•´](#-ì˜ì¡´ì„±-ê´€ë¦¬-ì´í•´)
- #### [ìë™ ì„¤ì • ì´í•´](#-ìë™-ì„¤ì •autoconfiguration-ì´í•´)
- #### [ë‚´ì¥ ì›¹ ì„œë²„ì˜ ì´í•´](-ë‚´ì¥-ì›¹-ì„œë²„ì˜-ì´í•´)
- #### [ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•œ JAR](-ë…ë¦½ì ìœ¼ë¡œ-ì‹¤í–‰-ê°€ëŠ¥í•œ-JAR)



# ğŸ“Œ ì˜ì¡´ì„± ê´€ë¦¬ ì´í•´
****

- ### ìŠ¤í”„ë§ ë¶€íŠ¸ì˜ ì˜ì¡´ì„± ê´€ë¦¬ : ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„œ ê´€ë¦¬í•˜ëŠ” ì˜ì¡´ì„± ë²„ì „ì„ ëª…ì‹œí•˜ì§€ ì•Šìœ¼ë©´ ìë™ìœ¼ë¡œ ì„¤ì •í•´ì¤Œ.

```xml
spring-boot-starter-parent > spring-boot-dependencies
```
![img.png](img3.png)
> - ë¶€ëª¨(spring-boot-starter-parent)ì˜ ë¶€ëª¨(spring-boot-dependencies)ì—ì„œ ë²„ì „ì„ ê´€ë¦¬í•´ì¤€ë‹¤.
> - ì˜ì¡´ì„±ì˜ ì„¤ì •, í˜¸í™˜ë˜ëŠ” ë²„ì „ì˜ ì„¤ì •ì„ ëŒ€ì‹ í•´ì£¼ê¸° ë•Œë¬¸ì— í¸ë¦¬í•˜ë‹¤.
> - ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„œ ê´€ë¦¬í•´ì£¼ì§€ ì•ŠëŠ” ì˜ì¡´ì„±ì˜ ê²½ìš°ì—ëŠ” ë²„ì „ì„ ëª…ì‹œí•´ì£¼ëŠ” ê²ƒì´ ì¢‹ë‹¤.
> - ì¸ì½”ë”©, ìë°” ë²„ì „ ì„¤ì •. ë¦¬ì†ŒìŠ¤ í•„í„°ë§, í”ŒëŸ¬ê·¸ì¸ ë“± ë‹¤ì–‘í•œ ì„¤ì • ì§€ì›.

    ğŸ§ Mavenì˜ì¡´ì„± : MVNRepository


- ### ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„œ ê´€ë¦¬í•˜ëŠ” ì˜ì¡´ì„±ì˜ ë²„ì „ ë³€ê²½
```xml
<properties>
    <java.version>11</java.version>
    <spring-framework.version>5.3.7</spring-framework.version>
</properties>
```
> ë‚´ í”„ë¡œì íŠ¸ì˜ pomì— propertiesë¡œ ë²„ì „ì„ ëª…ì‹œí•´ì£¼ë©´ ì¼ê´„ì ìœ¼ë¡œ ë³€ê²½ëœë‹¤. spring-boot-dependenciesì—ì„œ ì°¾ì„ ìˆ˜ ìˆë‹¤.



# ğŸ“Œ ìë™ ì„¤ì •(AutoConfiguration) ì´í•´
*****
> @SpringBootApplication
> > - @SpringBootConfiguration  
> > - @ComponentScan :@Componentë¥¼ ê°€ì§„ beanì„ ì½ì–´ ì˜´. í•´ë‹¹ ì• ë…¸í…Œì´ì…˜ì˜ íŒ¨í‚¤ì§€ë¥¼ ì‹œì‘ì ìœ¼ë¡œ.  
> > - @EnableAutoConfiguration : ìŠ¤í”„ë§ META-INF > spring_factories
> 
> ComponentScanìœ¼ë¡œ ë¹ˆì„ ì½ì–´ì˜¤ê³  EnableAutoConfiguration ìœ¼ë¡œ ì¶”ê°€ì ì¸ ë¹ˆì„ ì½ì–´ì˜¨ë‹¤.

    ğŸ§ @Componentë¥¼ ê°€ì§„ ì• ë…¸í…Œì´ì…˜ : @Component, @Configuration, @Repository, @Controller, @RestController, @Service ...

- AutoConfiguration
 ![img.png](img.png)
  
- ### ìë™ì„¤ì • ë§Œë“¤ê¸° : starterì™€ AutoConfigure
```java
public class HolomanConfiguration {

    @Bean
    public Holoman holoman(){
        Holoman holoman = new Holoman();
        holoman.setHowLong(5);
        holoman.setName("kim");
        return holoman;
    }
}
```
![img_2.png](img_2.png)
> ë‹¤ë¥¸ í”„ë¡œì íŠ¸ì—ì„œ Beanì„ ë“±ë¡í•˜ê³  AutoConfigurationì„ ë“±ë¡.


![img_1.png](img_1.png)
> ì‚¬ìš©í•  í”„ë¡œì íŠ¸ì—ì„œ ì˜ì¡´ì„±ì„ ì„¤ì •í•˜ë©´ ì´ì „ì— ìƒì„±í•œ íŒ¨í‚¤ì§€ê°€ ë“¤ì–´ì˜¨ ê²ƒì„ í™•ì¸ í•  ìˆ˜ ìˆë‹¤.
> 


```java
@Component
public class HolomanRunner implements ApplicationRunner {

    @Autowired
    Holoman holoman;

    @Override
    public void run(ApplicationArguments args) throws Exception {
        System.out.println(holoman);

    }
}
```
> í•´ë‹¹ í”„ë¡œì íŠ¸ì—ì„œëŠ” ë”°ë¡œ ë¹ˆì˜ ë“±ë¡ ì—†ì´ Autowiredë¡œ ì‚¬ìš© ê°€ëŠ¥í•˜ë‹¤.

> #### ğŸ‘ ë¬¸ì œ : í•´ë‹¹ í”„ë¡œì íŠ¸ì—ì„œ ê°™ì€ beanì„ ë“±ë¡í•´ë„ ComponentScanì´ ë¨¼ì € ì‹¤í–‰ëœ í›„ì— AutoConfigurationì´ ì‹¤í–‰ë˜ê¸° ë•Œë¬¸ì— í”„ë¡œì íŠ¸ì—ì„œ ë¹ˆì„ ì˜¤ë²„ë¼ì´ë”© í•  ìˆ˜ ì—†ë‹¤.

> #### ğŸ‘ í•´ê²° :
> 1. íŒ¨í‚¤ì§€ì—ì„œ ë¹ˆì„ ë“±ë¡í•  ë•Œ @ConditionalOnMissingBean ì• ë…¸í…Œì´ì…˜ì„ ë‹¬ì•„ë‘ë©´ ì‚¬ìš©í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œ ì´ Beanì´ ì¡´ì¬í•˜ì§€ ì•Šì„ë•Œë§Œ ë“±ë¡í•˜ê²Œ ëœë‹¤.
> 2. properties ì´ìš©.
> > - @ConfigurationProperties
> > - @EnableConfigurationProperties
 

- ### ìë™ì„¤ì • ë§Œë“¤ê¸° : propertiesë¥¼ ì‚¬ìš©í•˜ì—¬ bean ë³€ê²½.
```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-configuration-processor</artifactId>
    <optional>true</optional>
</dependency>
```

```java
@ConfigurationProperties("holoman")
public class HolomanProperties {
    private String name;
    private int howLong;

    public int getHowLong() {
        return howLong;
    }

    public void setHowLong(int howLong) {
        this.howLong = howLong;
    }

    public String getName() {
        return name;
    }

    public void setName(String name) {
        this.name = name;
    }
}
```

```java
@Configuration
@EnableConfigurationProperties(HolomanProperties.class)
public class HolomanConfiguration {

    @Bean
    @ConditionalOnMissingBean
    public Holoman holoman(HolomanProperties properties){
        Holoman holoman = new Holoman();
        holoman.setHowLong(properties.getHowLong());
        holoman.setName(properties.getName());
        return holoman;
    }
}
```
> AutoConfigurationì˜ ëŒ€ìƒì´ ë˜ëŠ” íŒ¨í‚¤ì§€ì—ì„œ propertiesë¥¼ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì •. application.propertiesì—ì„œ holomanì„ ì°¾ì•„ ê° ê°’ì„ set í•´ë‘ê³   Configuration í´ë˜ìŠ¤ì—ì„œ ê°’ì„ ë¹ˆì— ì£¼ì…í•œë‹¤.

```properties
holoman.name = ttt
holoman.howLong = 99
```
> ì‚¬ìš©í•˜ëŠ” í”„ë¡œì íŠ¸ì—ì„œëŠ” ë¹ˆì˜ ì¬ì •ì˜ ì—†ì´ propertiesë§Œì„ ì„¤ì •í•˜ì—¬ beanì˜ ê°’ì„ ë³€ê²½í•  ìˆ˜ ìˆë‹¤.



# ğŸ“Œ ë‚´ì¥ ì›¹ ì„œë²„ì˜ ì´í•´
****
> ë‚´ì¥ ì„œë¸”ë¦¿ ì»¨í…Œì´ë„ˆ

- #### ìŠ¤í”„ë§ ë¶€íŠ¸ëŠ” ì„œë²„ê°€ ì•„ë‹ˆë‹¤.
> 1. í†°ìº£ ê°ì²´ ìƒì„±.
> 2. í¬íŠ¸ ì„¤ì •.
> 3. í†°ìº£ì— ì»¨í…ìŠ¤íŠ¸ ì¶”ê°€.
> 4. ì„œë¸”ë¦¿ ë§Œë“¤ê¸°.
> 5. í†°ìº£ì— ì„œë¸”ë¦¿ ì¶”ê°€.
> 6. ì»¨í…ìŠ¤íŠ¸ì— ì„œë¸”ë¦¿ ë§¤í•‘.
> 7. í†°ìº£ ì‹¤í–‰ ë° ëŒ€ê¸°.

```java
Tomcat tomcat = new Tomcat();
tomcat.setPort(8080);

Context context = tomcat.addContext("/", "/");


HttpServlet servlet = new HttpServlet() {
  @Override
  protected void doGet(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
      PrintWriter writer = resp.getWriter();
      writer.println("<html><head><title>");
      writer.println("hello tomcat");
      writer.println("</title></head/>");
      writer.println("</html>");
  }
};
String servletName = "helloServlet";
tomcat.addServlet("/",servletName, servlet);
context.addServletMappingDecoded("/hello",servletName);

tomcat.start();
tomcat.getServer().await();
```

> ìŠ¤í”„ë§ ë¶€íŠ¸ì—ì„œëŠ” ìœ„ì˜ ê³¼ì •ì„ ìœ ì—°í•˜ê²Œ ì„¤ì •í•˜ê³  ì‹¤í–‰í•˜ê²Œ í•´ì¤€ë‹¤.
> > - ServletWebServerFactoryAutoConfiguration(ì„œë¸”ë¦¿ ì›¹ ì„œë²„ ìƒì„±.)
> > - TomcatServerFactoryAutoConfiguration(ì„œë²„ ì»¤ìŠ¤í„°ë§ˆì´ì§•.)
> > - DispatcherServletAutoConfiguration(ì„œë¸”ë¦¿ ë§Œë“¤ê³  ë“±ë¡.)


- ### ìŠ¤í”„ë§ì—ì„œ ë‹¤ë¥¸ ë‚´ì¥ ì›¹ ì„œë²„ ì‚¬ìš©í•˜ê¸°.

```xml
 <exclusions>
 <exclusion>
  <groupId>org.springframework.boot</groupId>
  <artifactId>spring-boot-starter-tomcat</artifactId>
 </exclusion>
</exclusions>
```
> spring-boot-starter-webì€ ê¸°ë³¸ì ìœ¼ë¡œ tomcatì„ ë„£ì–´ì£¼ê¸° ë•Œë¬¸ì— ì´ë¥¼ ì œì™¸ì‹œí‚¨ë‹¤.

```xml
<dependency>
    <groupId>org.springframework.boot</groupId>
    <artifactId>spring-boot-starter-jetty</artifactId>
</dependency>
```
> ë‹¤ë¥¸ ë‚´ì¥ ì›¹ ì„œë²„ ì˜ì¡´ì„± ì¶”ê°€. jetty, undertow ...
>
![img_3.png](img_3.png)

- ### ìŠ¤í”„ë§ì—ì„œ ë‹¤ë¥¸ ë‚´ì¥ ì›¹ ì„œë²„ ì‚¬ìš©í•˜ì§€ ì•Šê¸°.

```properties
spring.main.web-application-type=none
```

- ### í¬íŠ¸ ë³€ê²½
```properties
server.port = 8081

#random port
server.port = 0
```

- ### í¬íŠ¸ ì•Œì•„ë‚´ê¸° (ApplicationListener)
```java
@Component
public class PortListener implements ApplicationListener<ServletWebServerInitializedEvent> {
    @Override
    public void onApplicationEvent(ServletWebServerInitializedEvent servletWebServerInitializedEvent) {
        ServletWebServerApplicationContext context = servletWebServerInitializedEvent.getApplicationContext();
        System.out.println(context.getWebServer().getPort());
    }
```

## HTTPSì™€ HTTP2

### 1. HTTPS

1. keystore ìƒì„±.
```shell
 keytool -genkey -alias spring -storetype PKCS12 -keyalg RSA -keysize 2048 -keystore keystore.p12 -validity 4000
```

2.properties ì„¤ì •
```properties
server.ssl.key-store=classpath:keystore.p12
server.ssl.key-store-type=PKCS12
server.ssl.key-store-password=123123
server.ssl.key-alias=spring
```

3. httpsë¡œ ì ‘ì†.


### Https, Http ê°™ì´ ì‚¬ìš©í•˜ê¸°. (Connector ìƒì„±.)
```java
@Bean
public ServletWebServerFactory serverFactory(){
    TomcatServletWebServerFactory tomcat = new TomcatServletWebServerFactory();
    tomcat.addAdditionalTomcatConnectors(createStandardConnector());
    return tomcat;
}

private Connector createStandardConnector() {
    Connector connector = new Connector("org.apache.coyote.http11.Http11NioProtocol");
    connector.setPort(8080);
    return connector;
}
```
![img_4.png](img_4.png)

### 2.Http2 ì‚¬ìš©í•˜ê¸°.
```properties
server.http2.enabled=true
```

> - Tomcat ì„ ì‚¬ìš©í•  ê²½ìš° 9.0.x ë²„ì „ ì‚¬ìš©, java9 ì´ìƒ ì‚¬ìš©. (ì´í•˜ì˜ ë²„ì „ ì‚¬ìš©ì‹œ ì„¤ì •ì´ ë³µì¡.) 
> - ë˜ëŠ” undertowë¥¼ ì‚¬ìš©í•˜ë©´ ë³„ë‹¤ë¥¸ ì„¤ì •ì´ í•„ìš”í•˜ì§€ ì•Šë‹¤.
> 


# ğŸ“Œ ë…ë¦½ì ìœ¼ë¡œ ì‹¤í–‰ ê°€ëŠ¥í•œ JAR
*****
> - mvn packageë¥¼ í•˜ë©´ ì‹¤í–‰ ê°€ëŠ¥í•œ JAR íŒŒì¼ í•˜ë‚˜ê°€ ìƒì„± ë¨.
> - spring bootì˜ ì „ëµ.
> > - ë‚´ì¥ JAR : ê¸°ë³¸ì ìœ¼ë¡œ ìë°”ì—ëŠ” ë‚´ì¥ JARì„ ë¡œë”©í•˜ëŠ” í‘œì¤€ì´ ì—†ìŒ.
> > - ì• í”Œë¦¬ì¼€ì´ì…˜ í´ë˜ìŠ¤ì™€ ë¼ì´ë¸ŒëŸ¬ë¦¬ ìœ„ì¹˜ êµ¬ë¶„(ë¼ì´ë¸ŒëŸ¬ë¦¬ë„ ê°ê° JARë¡œ ê´€ë¦¬ë¨)
> > - org.springframework.boot.loader.jar.JarFile ì„ ì‚¬ìš©í•´ì„œ ë‚´ì¥ JARì„ ì½ìŒ. 
> > - org.springframework.boot.loader.Launcherì„ ì‚¬ìš©í•´ì„œ ì‹¤í–‰.



